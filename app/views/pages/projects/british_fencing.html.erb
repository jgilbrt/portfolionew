<% content_for :head do %>
  <style>
    :root {
      --primary-color: #0d6efd;
      --secondary-text: #6c757d;
      --border-color: #dee2e6;
      --card-bg: #fff;
      --body-bg: #f8f9fa;
      --card-shadow: 0 4px 15px rgba(0,0,0,0.06);
    }

    .case-study-body { background-color: var(--body-bg); }

    /* --- SCROLLNAV & BACK TO TOP --- */
    .scroll-nav { position: fixed; top: 50%; right: 2.5rem; transform: translateY(-50%); z-index: 10; }
    .scroll-nav ul { list-style: none; padding: 0; margin: 0; }
    .scroll-nav li { margin: 1.25rem 0; }
    .scroll-nav a { display: block; width: 12px; height: 12px; background-color: #dee2e6; border-radius: 50%; transition: all 0.3s ease; position: relative; }
    .scroll-nav a:hover { background-color: #adb5bd; transform: scale(1.2); }
    .scroll-nav a.active { background-color: var(--primary-color); transform: scale(1.5); }
    .scroll-nav .tooltip-text { visibility: hidden; width: 120px; background-color: #343a40; color: #fff; text-align: center; border-radius: 6px; padding: 5px 0; position: absolute; z-index: 1; top: 50%; right: 175%; transform: translateY(-50%); opacity: 0; transition: opacity 0.3s; pointer-events: none; }
    .scroll-nav a:hover .tooltip-text { visibility: visible; opacity: 1; }
    #back-to-top-btn { position: fixed; bottom: 2rem; right: 2.5rem; width: 40px; height: 40px; background-color: var(--card-bg); color: #495057; border-radius: 50%; text-align: center; line-height: 40px; font-size: 1.2rem; box-shadow: 0 4px 15px rgba(0,0,0,0.1); transition: opacity 0.3s, transform 0.3s; opacity: 0; transform: translateY(10px); pointer-events: none; z-index: 10;}
    #back-to-top-btn.show { opacity: 1; transform: translateY(0); pointer-events: auto; }
    #back-to-top-btn:hover { background-color: #f1f3f5; transform: translateY(-2px); }
    .hero-gif { width: 300px; height: 300px; border-radius: 2rem; object-fit: cover; box-shadow: 0 10px 30px rgba(0, 0, 0, 0.07); }

    /* --- REFINED QUOTE DISPLAY --- */
    .quote-display-wrapper {
        background-color: #fff;
        border-radius: 0.75rem;
        padding: 2rem;
        box-shadow: var(--card-shadow);
        border: 1px solid var(--border-color);
    }
    .quote-text-container {
        min-height: 100px; /* Prevent layout shift */
        position: relative;
    }
    .quote-text-container p {
        font-size: 1.1rem;
        font-style: italic;
        color: var(--secondary-text);
        border-left: 3px solid var(--primary-color);
        padding-left: 1.5rem;
        transition: opacity 0.3s ease-in-out;
        position: absolute;
        width: 100%;
        opacity: 0;
    }
    .quote-text-container p.active {
        opacity: 1;
    }
    .quote-nav {
        display: flex;
        justify-content: flex-end;
        align-items: center;
        margin-top: 1rem;
        user-select: none;
    }
    .quote-pagination {
        font-size: 0.9rem;
        color: var(--secondary-text);
        font-weight: 500;
        min-width: 40px;
        text-align: center;
    }
    .quote-nav-btn {
        background: #e9ecef;
        border: none;
        border-radius: 50%;
        width: 36px;
        height: 36px;
        color: var(--secondary-text);
        margin: 0 0.25rem;
        transition: all 0.2s ease;
    }
    .quote-nav-btn:hover {
        background-color: #dee2e6;
        color: #212529;
    }
    .quote-nav-btn:disabled {
        opacity: 0.5;
        cursor: not-allowed;
    }

    /* --- REFINED ACCORDION --- */
    .custom-accordion .accordion-item {
      background-color: transparent;
      border: none;
    }
    .custom-accordion .accordion-button {
      font-weight: 600;
      color: #212529;
      background-color: var(--card-bg);
      border-radius: 0.5rem !important;
      border: 1px solid var(--border-color);
      box-shadow: var(--card-shadow);
      padding: 1.25rem;
      text-align: left;
    }
    .custom-accordion .accordion-button:not(.collapsed) {
      color: var(--primary-color);
      background-color: #e7f1ff;
      border-bottom-left-radius: 0 !important;
      border-bottom-right-radius: 0 !important;
      border-color: #b3d1ff;
    }
    .custom-accordion .accordion-button:focus { box-shadow: 0 0 0 0.25rem rgba(13,110,253,.25); }
    .custom-accordion .accordion-button::after { display: none; }
    .custom-accordion .accordion-icon {
      margin-left: auto;
      transition: transform 0.3s ease;
      font-size: 1.5rem;
      font-weight: 300;
      line-height: 1;
    }
    .custom-accordion .accordion-button:not(.collapsed) .accordion-icon { transform: rotate(45deg); }
    .custom-accordion .accordion-body {
      padding: 1.5rem;
      background-color: var(--card-bg);
      border: 1px solid #b3d1ff;
      border-top: none;
      border-bottom-left-radius: 0.5rem;
      border-bottom-right-radius: 0.5rem;
    }
    .custom-accordion .accordion-item + .accordion-item { margin-top: 1rem; }

    @media (max-width: 992px) {
      .scroll-nav { display: none; }
      .hero-gif { width: 220px; height: 220px; }
      .hero-section-content { text-align: center; }
      #back-to-top-btn { right: 1.5rem; bottom: 1.5rem; }
    }
  </style>
<% end %>

<a id="back-to-top-btn" href="#"><i class="bi bi-arrow-up"></i></a>

<nav class="scroll-nav">
  <ul>
    <li><a href="#intro" data-section="intro" class="active"><span class="tooltip-text">Intro</span></a></li>
    <li><a href="#research" data-section="research"><span class="tooltip-text">Research</span></a></li>
    <li><a href="#problem" data-section="problem"><span class="tooltip-text">Problem</span></a></li>
    <li><a href="#validation" data-section="validation"><span class="tooltip-text">Validation</span></a></li>
    <li><a href="#prototype" data-section="prototype"><span class="tooltip-text">Prototype</span></a></li>
    <li><a href="#impact" data-section="impact"><span class="tooltip-text">Impact & CTA</span></a></li>
  </ul>
</nav>

<div class="case-study-body">
  <div class="container section-padding">

    <section class="mb-5 pb-5">
      <div class="row align-items-center">
        <div class="col-lg-7 hero-section-content">
          <h1 class="display-light mb-3">British Fencing</h1>
          <p class="lead text-success fw-bold">Improved User Satisfaction By 146.3%</p>
          <hr class="my-4">
          <div class="row">
            <div class="col-md-4 mb-3 mb-md-0"><h6 class="text-muted text-uppercase fw-bold small">Toolkit</h6><p class="mb-0">Figma, Optimal Workshop, Jira, Ballpark, Useberry</p></div>
            <div class="col-md-4 mb-3 mb-md-0"><h6 class="text-muted text-uppercase fw-bold small">Timeline</h6><p class="mb-0">3 Weeks</p></div>
            <div class="col-md-4"><h6 class="text-muted text-uppercase fw-bold small">Team</h6><p class="mb-0">UX Research Team</p></div>
          </div>
        </div>
        <div class="col-lg-5 text-center mt-4 mt-lg-0"><img src="https://freight.cargo.site/t/original/i/5b4cc062d685ba39a884774e058e39e1070f33430879e0af609e8a8bc4674a0f/006_Cardsort_Square_1.gif" alt="British Fencing Interface" class="hero-gif"></div>
      </div>
    </section>

    <section id="intro" class="mb-5 animate__animated animate__fadeInUp">
      <div class="content-card p-4 p-md-5"><div class="d-flex align-items-start gap-3 mb-4"><span class="h1 text-primary opacity-50">01</span><h2 class="display-6 mt-2">Intro</h2></div><div class="text-secondary lead-sm"><p>British Fencing approached us as their users consistently reported difficulties in navigating their website. It was cluttered, overwhelming and key info was buried within their site structure. Their primary goal wasn't a visual overhaul, but to research and outline the most efficient way for British Fencing to <strong>restructure their information</strong>, based on user insights. Providing a structure that they could confidently build upon for future digital projects.</p></div></div>
    </section>

    <section id="research" class="mb-5 animate__animated animate__fadeInUp">
      <div class="content-card p-4 p-md-5">
        <div class="d-flex align-items-start gap-3 mb-4"><span class="h1 text-danger opacity-50">02</span><h2 class="display-6 mt-2">Research</h2></div>
        <p class="text-secondary lead-sm mb-5">Our research phase combined qualitative and quantitative methods to uncover usability challenges. Our user group included competitive fencers, coaches, parents, and total beginners — helping us identify universal blockers and audience-specific struggles.</p>

        <div class="mb-5">
          <h4 class="fw-semibold">User Interviews</h4>
          <p class="text-secondary mb-4">Interviews confirmed the quantitative data, revealing a deep frustration with the site's complexity and information architecture. Key themes emerged:</p>
          <div class="quote-display-wrapper">
            <div class="quote-text-container">
              <p class="quote-content">"I didn't feel like the information that I need as a parent new to fencing, was well presented to me."</p>
              <p class="quote-content">"It feels overcomplicated... they are trying to get too much information on one page."</p>
              <p class="quote-content">"It feels like it's been put there by someone for their reasons with things that people might access for their own reasons."</p>
              <p class="quote-content">"If I'm looking for something I'm going to use Google because the menu and the context menus beneath that, they're just really difficult to understand."</p>
            </div>
            <div class="quote-nav">
              <button id="prevQuote" class="quote-nav-btn"><i class="bi bi-arrow-left"></i></button>
              <span id="quotePagination" class="quote-pagination"></span>
              <button id="nextQuote" class="quote-nav-btn"><i class="bi bi-arrow-right"></i></button>
            </div>
          </div>
        </div>

        <hr class="my-5">

        <div>
          <h4 class="fw-semibold">Heuristic Evaluation</h4>
          <p class="text-secondary mb-4">An audit against usability heuristics highlighted critical issues that aligned with user feedback.</p>
          <div class="accordion custom-accordion" id="heuristicAccordion">
            <div class="accordion-item">
              <h2 class="accordion-header">
                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne" aria-expanded="false" aria-controls="collapseOne">
                  Lack of Breadcrumb Navigation <span class="accordion-icon">+</span>
                </button>
              </h2>
              <div id="collapseOne" class="accordion-collapse collapse" data-bs-parent="#heuristicAccordion">
                <div class="accordion-body">
                  <div class="row g-4 align-items-center">
                    <div class="col-md-7"><p class="small">The site lacks breadcrumb navigation, making it difficult for users to know their current location and harder to return to previous pages.</p></div>
                    <div class="col-md-5"><img src="https://framerusercontent.com/images/5N2TN8GOf78LpBN7uXjRQI0l9Y.png" alt="Screenshot showing lack of breadcrumb navigation" class="img-fluid rounded border"></div>
                  </div>
                </div>
              </div>
            </div>
            <div class="accordion-item">
              <h2 class="accordion-header">
                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
                  Inconsistent Navigation Menus <span class="accordion-icon">+</span>
                </button>
              </h2>
              <div id="collapseTwo" class="accordion-collapse collapse" data-bs-parent="#heuristicAccordion">
                <div class="accordion-body">
                  <div class="row g-4 align-items-center">
                    <div class="col-md-7 order-md-2"><p class="small">Two inconsistent navigation bars create an unpredictable journey for users, especially those unfamiliar with the site or people with limited technical skills.</p></div>
                    <div class="col-md-5 order-md-1"><img src="https://framerusercontent.com/images/hN4hm3QbOSVgDpUdnQDlQRwixE.png" alt="Screenshot showing inconsistent navigation menus" class="img-fluid rounded border"></div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <section id="problem" class="mb-5 animate__animated animate__fadeInUp">
      <div class="content-card p-4 p-md-5"><div class="d-flex align-items-start gap-3 mb-4"><span class="h1 text-info opacity-50">03</span><h2 class="display-6 mt-2">Problem</h2></div><p class="text-secondary lead-sm mb-5">Our research was synthesized into a key persona, Tom, to represent our primary user group and ensure our solutions directly addressed his needs and frustrations.</p><div class="row g-4 justify-content-center"><div class="col-lg-8"><div class="content-card p-4 h-100"><div class="d-flex align-items-center mb-3"><img src="https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?q=80&w=400&auto=format&fit=crop" alt="Persona of Tom" class="rounded-circle me-3" style="width: 75px; height: 75px; object-fit: cover;"><div><h4 class="fw-semibold mb-0">Tom Smith, 32</h4><p class="text-secondary mb-0">Competitive Fencer & Coach</p></div></div><p class="text-secondary"><strong class="text-dark">Bio:</strong> Tom is an experienced fencer and coach who uses the British Fencing website to find event schedules, rankings, and results. With a full-time job, he doesn't have much free time and needs to find information quickly.</p><blockquote class="blockquote mt-3 border-start border-4 border-warning ps-3"><p class="mb-0 fst-italic small">"Knowledge within fencing empowers me"</p></blockquote></div></div></div><div class="bg-light p-4 rounded mt-5"><h5 class="fw-bold text-center">Problem Statement</h5><p class="text-center text-secondary fst-italic mb-0">"How might we help Tom save time using the British Fencing Website so that it becomes a source of joy rather than frustration?"</p></div></div>
    </section>

    <section id="validation" class="mb-5 animate__animated animate__fadeInUp">
      <div class="content-card p-4 p-md-5">
        <div class="d-flex align-items-start gap-3 mb-4"><span class="h1 text-warning opacity-50">04</span><h2 class="display-6 mt-2">Testing & Validation</h2></div>
        <div class="accordion custom-accordion" id="validationAccordion">
          <div class="accordion-item">
            <h2 class="accordion-header">
              <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseValidationOne" aria-expanded="false" aria-controls="collapseValidationOne">
                Card Sort & New Site Map <span class="accordion-icon">+</span>
              </button>
            </h2>
            <div id="collapseValidationOne" class="accordion-collapse collapse" data-bs-parent="#validationAccordion">
              <div class="accordion-body">
                <div class="row g-4 align-items-center">
                  <div class="col-lg-6">
                    <p class="text-secondary">We conducted an <strong>open card sort</strong> with 21 participants to understand how users naturally group content. This allowed us to formulate a new, user-centric information architecture.</p>
                  </div>
                  <div class="col-lg-6">
                    <img src="https://framerusercontent.com/images/lKVzI1ENzeBM23Fhntu2Ay3SR8.png" alt="Card Sort Results" class="img-fluid rounded border">
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="accordion-item">
            <h2 class="accordion-header">
              <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseValidationTwo" aria-expanded="false" aria-controls="collapseValidationTwo">
                Tree Testing & Validation <span class="accordion-icon">+</span>
              </button>
            </h2>
            <div id="collapseValidationTwo" class="accordion-collapse collapse" data-bs-parent="#validationAccordion">
              <div class="accordion-body">
                <div class="row g-4 align-items-center">
                  <div class="col-lg-6 order-lg-2">
                    <p class="text-secondary">To validate the new site map, we ran <strong>tree testing</strong> with 15 users. The results showed a dramatic improvement across all metrics.</p>
                    <ul class="list-unstyled mt-3 text-secondary">
                      <li>✅ <strong>Task Success Rate:</strong> Rose to 93% (from 33%)</li>
                      <li>⏱️ <strong>Avg. Completion Time:</strong> Reduced to 13.7s (from ~4 mins)</li>
                      <li>📈 <strong>SUS Score:</strong> Improved to 85/100 (from 34/100)</li>
                    </ul>
                  </div>
                  <div class="col-lg-6 order-lg-1">
                    <img src="https://framerusercontent.com/images/I0FnGvakGzuCQU737eJx3UC0y0.png" alt="Tree Test Results" class="img-fluid rounded border">
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <section id="prototype" class="mb-5 animate__animated animate__fadeInUp">
      <div class="content-card p-4 p-md-5"><div class="d-flex align-items-start gap-3 mb-4"><span class="h1 text-success opacity-50">05</span><h2 class="display-6 mt-2">Prototype</h2></div><p class="text-secondary lead-sm mb-4">While a high-fidelity prototype wasn't a primary deliverable, we built a conceptual model to visualise how the new information architecture would translate into a functional navigation system, providing a clear blueprint for future development.</p><div class="content-card p-2"><iframe style="border: none; border-radius: 0.8rem;" width="100%" height="450" src="https://embed.figma.com/proto/kOryuIf2B7whpqDxSVRCzg/Wireframes?node-id=466-1210&p=f&scaling=scale-down&content-scaling=fixed&page-id=466%3A1204&starting-point-node-id=466%3A1210&embed-host=share" allowfullscreen></iframe></div></div>
    </section>

    <%= render 'shared/other_projects' %>

    <section id="impact" class="text-center">
       <%= link_to "← Back to Projects", projects_path, class: "cta-button" %>
    </section>
  </div>
</div>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    // Quote Rotator Logic
    const quotes = document.querySelectorAll('.quote-content');
    const prevBtn = document.getElementById('prevQuote');
    const nextBtn = document.getElementById('nextQuote');
    const pagination = document.getElementById('quotePagination');
    let currentQuoteIndex = 0;

    function showQuote(index) {
      quotes.forEach((quote, i) => {
        quote.classList.remove('active');
        if (i === index) {
          quote.classList.add('active');
        }
      });
      pagination.textContent = `${index + 1} / ${quotes.length}`;
      prevBtn.disabled = index === 0;
      nextBtn.disabled = index === quotes.length - 1;
    }

    if (quotes.length > 0) {
        prevBtn.addEventListener('click', () => {
          if (currentQuoteIndex > 0) {
            currentQuoteIndex--;
            showQuote(currentQuoteIndex);
          }
        });

        nextBtn.addEventListener('click', () => {
          if (currentQuoteIndex < quotes.length - 1) {
            currentQuoteIndex++;
            showQuote(currentQuoteIndex);
          }
        });

        showQuote(currentQuoteIndex);
    }
  });
</script>
